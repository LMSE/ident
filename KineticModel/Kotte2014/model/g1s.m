function out = g1s
out{1} = @init;
out{2} = @fun_eval;
out{3} = @jacobian;
out{4} = [];
out{5} = [];
out{6} = [];
out{7} = [];
out{8} = [];
out{9} = [];

function dM = fun_eval(t,x,k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm)
pvec = [k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm];
dM = g1sNLAE(x,[],pvec);

function [tspan,y0,options] = init
handles = feval(g1s);

% obtain initial steady states
y0 = zeros(1,6);
% substitute this with SUNDIALS
% odefun = @(t,x)designODE(t,x,pi,ps);
% [~,yout] = ode45(odefun,0:0.1:30,M);
% y0 = yout(end,:);
options = odeset('Jacobian',handles(3),'JacobianP',handles(4),...
                 'Hessians',handles(4),'HessiansP',handles(5));
tspan = [0 1000];

function jac = jacobian(t,x,k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm)
pvec = [k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm];  
jac = getKotteJacobian(@g1sNLAE,x,pvec,[]);
    

function jacp = jacobianp(t,x,k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm)      
                     
function jacp = hessians(t,x,k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm)           
                     
function jacp = hessiansp(t,x,k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm)      

function jacp = der3(t,x,k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm)    
                     
function jacp = der4(t,x,k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm)    
                     
function jacp = der5(t,x,k1,k2,k3,k16,k61,k34,k43,k67,k76,k23,k25,k28,k89,k98,a,...
        j11,j12,j13,j15,j18,j61,j62,j63,j65,j68,...
        Km1,Km2,Km4,Km9,kp,...
        phipRB,phiE2F1,phiCycDi,phiCycDa,...
        phiAP1,phipRBp,phipRBpp,phiCycEi,phiCycEa,...
        Fm)          