syms v1 v2 v3 v4 v5 v6 v7 vpfk vpgi mu f6p Sf6p...
    vgnd ru5p xu5p r5p Sr5p s7p e4p Se4p vfba vtpi g3p Sg3p
S = [1 1 1 0 0 0 0;...
     0 0 0 -1 1 0 0;...
     0 0 -1 1 0 -1 0;...
     0 0 0 0 -1 -1 0;...
     0 -1 0 0 0 -1 0;...
     0 1 -1 0 0 0 0;...
     0 -1 1 0 0 1 -1];
 b = [vpfk-vpgi+mu*(f6p+Sf6p);...
      -vgnd+mu*ru5p;...
      mu*xu5p;...
      mu*(r5p+Sr5p);...
      mu*s7p;...
      mu*(e4p+Se4p);...
      -vfba-vtpi+mu*(g3p+Sg3p)];
  v = S\b;